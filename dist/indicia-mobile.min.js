!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.IndiciaMobile=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(){"use strict";function d(a){var b=a.split(/\r\n|\r|\n/g);return{usersecret:b[0],firstname:b[1],lastname:b[2]}}var e,f;a("es6-promise").polyfill(),"undefined"!=typeof window?(e=window.XMLHttpRequest,f=window.FormData):(e=a("xmlhttprequest").XMLHttpRequest,f=a("form-data"));var g=function(a){this.baseUrl=a.baseUrl,this.appname=a.appname,this.appsecret=a.appsecret,this.credentials={usersecret:a.usersecret||null,email:a.email||null}};g.prototype._request=function(a,b){var c=a.indexOf("//")>=0?a:this.baseUrl+a;c=c+(/\?/.test(c)?"&":"?")+(new Date).getTime();var d=new f;for(var g in b)b.hasOwnProperty(g)&&d.append(g,b[g]);return d.append("appname",this.appname),d.append("appsecret",this.appsecret),new Promise("undefined"==typeof window?function(a,b){d.submit(c,function(c,d){if(c)return b(Error(c));var e="";d.on("data",function(a){e+=a}),d.on("end",function(){d.statusCode>=200&&d.statusCode<300?a({body:e,response:d}):b(Error(e))})})}:function(a,b){var f=new e;f.open("POST",c),f.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<300?a({body:this.responseText,response:this}):b(this.status))},f.send(d)})},g.prototype.login=function(a,b){var c=this;return this._request("/user/mobile/register",{email:a,password:b}).then(function(b){return b=d(b.body),c.credentials={email:a,usersecret:b.usersecret},c.credentials})},g.prototype.logout=function(){this.credentials={usersecret:null,email:null}},g.prototype.isLoggedIn=function(){return!!this.credentials.usersecret},g.prototype.register=function(a){var b=this;this._request("/user/mobile/register",a).then(function(c){return c=d(c.body),b.credentials={email:a.email,usersecret:c.usersecret},b.credentials})},g.prototype.report=function(a){return a=a||{},this.isLoggedIn()?this._request("/mobile/report",{email:this.credentials.email,usersecret:this.credentials.usersecret,report:a.report||"library/totals/user_survey_contribution_summary.xml",survey_id:a.survey_id}).then(function(a){return JSON.parse(a.body)}):Promise.reject(Error("Must be logged in"))},g.prototype.submit=function(a){return this.isLoggedIn()?this._request("/mobile/submit",a).then(function(a){return a.body}):Promise.reject(Error("Must be logged in"))},"undefined"!=typeof c?b.exports=g:window.IndiciaMobile=g}).call(this)},{"es6-promise":2,"form-data":3,xmlhttprequest:3}],2:[function(b,c,d){(function(d,e){(function(){"use strict";function f(a){return"function"==typeof a||"object"==typeof a&&null!==a}function g(a){return"function"==typeof a}function h(a){return"object"==typeof a&&null!==a}function i(a,b){aa[V]=a,aa[V+1]=b,V+=2,2===V&&T()}function j(){var a=d.nextTick,b=d.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(b)&&"0"===b[1]&&"10"===b[2]&&(a=setImmediate),function(){a(o)}}function k(){return function(){S(o)}}function l(){var a=0,b=new Z(o),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function m(){var a=new MessageChannel;return a.port1.onmessage=o,function(){a.port2.postMessage(0)}}function n(){return function(){setTimeout(o,1)}}function o(){for(var a=0;V>a;a+=2){var b=aa[a],c=aa[a+1];b(c),aa[a]=void 0,aa[a+1]=void 0}V=0}function p(){try{var a=b,c=a("vertx");return S=c.runOnLoop||c.runOnContext,k()}catch(d){return n()}}function q(){}function r(){return new TypeError("You cannot resolve a promise with itself")}function s(){return new TypeError("A promises callback cannot return that same promise.")}function t(a){try{return a.then}catch(b){return ea.error=b,ea}}function u(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function v(a,b,c){W(function(a){var d=!1,e=u(c,b,function(c){d||(d=!0,b!==c?y(a,c):A(a,c))},function(b){d||(d=!0,B(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,B(a,e))},a)}function w(a,b){b._state===ca?A(a,b._result):b._state===da?B(a,b._result):C(b,void 0,function(b){y(a,b)},function(b){B(a,b)})}function x(a,b){if(b.constructor===a.constructor)w(a,b);else{var c=t(b);c===ea?B(a,ea.error):void 0===c?A(a,b):g(c)?v(a,b,c):A(a,b)}}function y(a,b){a===b?B(a,r()):f(b)?x(a,b):A(a,b)}function z(a){a._onerror&&a._onerror(a._result),D(a)}function A(a,b){a._state===ba&&(a._result=b,a._state=ca,0!==a._subscribers.length&&W(D,a))}function B(a,b){a._state===ba&&(a._state=da,a._result=b,W(z,a))}function C(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+ca]=c,e[f+da]=d,0===f&&a._state&&W(D,a)}function D(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?G(c,d,e,f):e(f);a._subscribers.length=0}}function E(){this.error=null}function F(a,b){try{return a(b)}catch(c){return fa.error=c,fa}}function G(a,b,c,d){var e,f,h,i,j=g(c);if(j){if(e=F(c,d),e===fa?(i=!0,f=e.error,e=null):h=!0,b===e)return void B(b,s())}else e=d,h=!0;b._state!==ba||(j&&h?y(b,e):i?B(b,f):a===ca?A(b,e):a===da&&B(b,e))}function H(a,b){try{b(function(b){y(a,b)},function(b){B(a,b)})}catch(c){B(a,c)}}function I(a,b){var c=this;c._instanceConstructor=a,c.promise=new a(q),c._validateInput(b)?(c._input=b,c.length=b.length,c._remaining=b.length,c._init(),0===c.length?A(c.promise,c._result):(c.length=c.length||0,c._enumerate(),0===c._remaining&&A(c.promise,c._result))):B(c.promise,c._validationError())}function J(a){return new ga(this,a).promise}function K(a){function b(a){y(e,a)}function c(a){B(e,a)}var d=this,e=new d(q);if(!U(a))return B(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,g=0;e._state===ba&&f>g;g++)C(d.resolve(a[g]),void 0,b,c);return e}function L(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(q);return y(c,a),c}function M(a){var b=this,c=new b(q);return B(c,a),c}function N(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function O(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function P(a){this._id=la++,this._state=void 0,this._result=void 0,this._subscribers=[],q!==a&&(g(a)||N(),this instanceof P||O(),H(this,a))}function Q(){var a;if("undefined"!=typeof e)a=e;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(b){throw new Error("polyfill failed because global object is unavailable in this environment")}var c=a.Promise;(!c||"[object Promise]"!==Object.prototype.toString.call(c.resolve())||c.cast)&&(a.Promise=ma)}var R;R=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var S,T,U=R,V=0,W=({}.toString,i),X="undefined"!=typeof window?window:void 0,Y=X||{},Z=Y.MutationObserver||Y.WebKitMutationObserver,$="undefined"!=typeof d&&"[object process]"==={}.toString.call(d),_="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,aa=new Array(1e3);T=$?j():Z?l():_?m():void 0===X&&"function"==typeof b?p():n();var ba=void 0,ca=1,da=2,ea=new E,fa=new E;I.prototype._validateInput=function(a){return U(a)},I.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},I.prototype._init=function(){this._result=new Array(this.length)};var ga=I;I.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===ba&&b>e;e++)a._eachEntry(d[e],e)},I.prototype._eachEntry=function(a,b){var c=this,d=c._instanceConstructor;h(a)?a.constructor===d&&a._state!==ba?(a._onerror=null,c._settledAt(a._state,b,a._result)):c._willSettleAt(d.resolve(a),b):(c._remaining--,c._result[b]=a)},I.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===ba&&(d._remaining--,a===da?B(e,c):d._result[b]=c),0===d._remaining&&A(e,d._result)},I.prototype._willSettleAt=function(a,b){var c=this;C(a,void 0,function(a){c._settledAt(ca,b,a)},function(a){c._settledAt(da,b,a)})};var ha=J,ia=K,ja=L,ka=M,la=0,ma=P;P.all=ha,P.race=ia,P.resolve=ja,P.reject=ka,P.prototype={constructor:P,then:function(a,b){var c=this,d=c._state;if(d===ca&&!a||d===da&&!b)return this;var e=new this.constructor(q),f=c._result;if(d){var g=arguments[d-1];W(function(){G(d,e,g,f)})}else C(c,e,a,b);return e},"catch":function(a){return this.then(null,a)}};var na=Q,oa={Promise:ma,polyfill:na};"function"==typeof a&&a.amd?a(function(){return oa}):"undefined"!=typeof c&&c.exports?c.exports=oa:"undefined"!=typeof this&&(this.ES6Promise=oa),na()}).call(this)}).call(this,b("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:4}],3:[function(a,b,c){},{}],4:[function(a,b,c){function d(){if(!h){h=!0;for(var a,b=g.length;b;){a=g,g=[];for(var c=-1;++c<b;)a[c]();b=g.length}h=!1}}function e(){}var f=b.exports={},g=[],h=!1;f.nextTick=function(a){g.push(a),h||setTimeout(d,0)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=e,f.addListener=e,f.once=e,f.off=e,f.removeListener=e,f.removeAllListeners=e,f.emit=e,f.binding=function(a){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(a){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}]},{},[1])(1)});